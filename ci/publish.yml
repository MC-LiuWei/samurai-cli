steps:

- checkout: self
  clean: true

- script: npm install
  displayName: npm install

- script: tsc
  displayName: build

- script: npm run update:version
  displayName: update version

- task: npmAuthenticate@0
  displayName: "auth"
  inputs:
    workingFile: .npmrc
    customEndpoint: "npm"

- task: Npm@0
  displayName: 'publish'
  inputs:
    command: "publish"
    publishRegistry: 'useExternalRegistry'
    publishPackageMetadata: true
    publishEndpoint: "npm"